<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subscription Plans - TSG Cafe ERP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .plans-header {
            text-align: center;
            color: white;
            padding: 60px 20px 40px;
        }
        
        .plans-header h1 {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .plans-header p {
            font-size: 1.2rem;
            opacity: 0.95;
        }
        
        .period-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0 50px;
            flex-wrap: wrap;
        }
        
        .period-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.4);
            color: white;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .period-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .period-btn.active {
            background: white;
            color: #667eea;
            border-color: white;
        }
        
        .period-badge {
            position: absolute;
            top: -10px;
            right: -10px;
            background: #ff6b6b;
            color: white;
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .plan-card {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .plan-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .plan-card.featured {
            border: 3px solid #667eea;
            position: relative;
        }
        
        .featured-badge {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 20px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .plan-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 35px;
            color: white;
        }
        
        .plan-name {
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            color: #2d3748;
        }
        
        .plan-description {
            text-align: center;
            color: #718096;
            font-size: 0.95rem;
            margin-bottom: 25px;
            min-height: 45px;
        }
        
        .plan-price {
            text-align: center;
            margin-bottom: 10px;
        }
        
        .price-amount {
            font-size: 3rem;
            font-weight: bold;
            color: #667eea;
        }
        
        .price-period {
            font-size: 1rem;
            color: #718096;
        }
        
        .price-monthly {
            font-size: 0.9rem;
            color: #a0aec0;
            margin-top: 5px;
        }
        
        .discount-badge {
            display: inline-block;
            background: #48bb78;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .features-list {
            list-style: none;
            padding: 0;
            margin: 25px 0;
            flex-grow: 1;
        }
        
        .features-list li {
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            font-size: 0.95rem;
        }
        
        .features-list li:last-child {
            border-bottom: none;
        }
        
        .features-list i {
            color: #48bb78;
            margin-right: 12px;
            font-size: 18px;
        }
        
        .select-plan-btn {
            width: 100%;
            padding: 15px;
            border-radius: 50px;
            border: none;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: auto;
        }
        
        .btn-cafe {
            background: linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%);
            color: white;
        }
        
        .btn-restaurant {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-hotel {
            background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
            color: white;
        }
        
        .select-plan-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 24px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            transform: translateY(-2px);
        }
        
        @media (max-width: 768px) {
            .plans-header h1 {
                font-size: 2rem;
            }
            
            .period-selector {
                gap: 10px;
            }
            
            .period-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <a href="{{ url_for('root') }}" class="back-btn">
        <i class="fas fa-arrow-left me-2"></i>Back to Home
    </a>

    <div class="container">
        <div class="plans-header">
            <h1>Choose Your Perfect Plan</h1>
            <p>Select the plan that fits your business needs and watch your operations transform</p>
            
            <!-- Subscription Period Selector -->
            <div class="period-selector">
                {% for months, period in periods.items() %}
                <button class="period-btn {{ 'active' if months == 1 else '' }}" 
                        onclick="selectPeriod({{ months }})" 
                        data-period="{{ months }}">
                    {{ period.name }}
                    {% if period.get('badge') %}
                    <span class="period-badge">{{ period.badge }}</span>
                    {% endif %}
                </button>
                {% endfor %}
            </div>
        </div>

        <!-- Plans Grid -->
        <div class="row g-4 mb-5">
            {% for plan_key, plan in plans.items() %}
            <div class="col-lg-4 col-md-6">
                <div class="plan-card {{ 'featured' if plan_key == 'restaurant' else '' }}" data-plan="{{ plan_key }}">
                    {% if plan_key == 'restaurant' %}
                    <div class="featured-badge">Most Popular</div>
                    {% endif %}
                    
                    <div class="plan-icon">
                        <i class="fas {{ plan.icon }}"></i>
                    </div>
                    
                    <h3 class="plan-name">{{ plan.name }}</h3>
                    <p class="plan-description">{{ plan.description }}</p>
                    
                    <div class="plan-price">
                        <div class="discount-badge" style="display: none;" data-discount-badge>
                            Save <span class="discount-percent">0</span>%
                        </div>
                        <div>
                            <span class="price-amount">$<span class="plan-price-value" data-plan="{{ plan_key }}" data-period="1">{{ plan.pricing[1] }}</span></span>
                            <span class="price-period">/ <span class="period-text">month</span></span>
                        </div>
                        <div class="price-monthly">
                            $<span class="monthly-price">{{ plan.pricing[1] }}</span>/month
                        </div>
                    </div>
                    
                    <ul class="features-list">
                        {% for feature in plan.features %}
                        <li>
                            <i class="fas fa-check-circle"></i>
                            <span>{{ feature }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                    
                    <button class="select-plan-btn btn-{{ plan_key }}" 
                            onclick="selectPlan('{{ plan_key }}', 1)">
                        Start 14-Day Free Trial
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
        // Store all plan pricing data
        const planPricing = {
            {% for plan_key, plan in plans.items() %}
            '{{ plan_key }}': {
                {% for months, price in plan.pricing.items() %}
                {{ months }}: {{ price }}{{ ',' if not loop.last else '' }}
                {% endfor %}
            }{{ ',' if not loop.last else '' }}
            {% endfor %}
        };
        
        const periodInfo = {
            {% for months, period in periods.items() %}
            {{ months }}: {
                name: '{{ period.name }}',
                discount: {{ period.discount }},
                badge: '{{ period.get("badge", "") }}'
            }{{ ',' if not loop.last else '' }}
            {% endfor %}
        };
        
        let selectedPeriod = 1;
        
        function selectPeriod(months) {
            selectedPeriod = months;
            
            // Update period button active state
            document.querySelectorAll('.period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-period="${months}"]`).classList.add('active');
            
            // Update all plan prices
            Object.keys(planPricing).forEach(planKey => {
                updatePlanPrice(planKey, months);
            });
            
            // Update period text
            const periodText = months === 1 ? 'month' : `${months} months`;
            document.querySelectorAll('.period-text').forEach(el => {
                el.textContent = periodText;
            });
            
            // Show/hide discount badge
            const discount = periodInfo[months].discount;
            document.querySelectorAll('[data-discount-badge]').forEach(badge => {
                if (discount > 0) {
                    badge.style.display = 'inline-block';
                    badge.querySelector('.discount-percent').textContent = discount;
                } else {
                    badge.style.display = 'none';
                }
            });
        }
        
        function updatePlanPrice(planKey, months) {
            const totalPrice = planPricing[planKey][months];
            const monthlyPrice = (totalPrice / months).toFixed(2);
            
            // Update total price
            const priceElement = document.querySelector(`.plan-price-value[data-plan="${planKey}"]`);
            if (priceElement) {
                priceElement.textContent = totalPrice;
            }
            
            // Update monthly equivalent
            const monthlyElement = priceElement.closest('.plan-price').querySelector('.monthly-price');
            if (monthlyElement) {
                monthlyElement.textContent = monthlyPrice;
            }
            
            // Update button onclick
            const button = priceElement.closest('.plan-card').querySelector('.select-plan-btn');
            if (button) {
                button.setAttribute('onclick', `selectPlan('${planKey}', ${months})`);
            }
        }
        
        function selectPlan(planKey, months) {
            // Store selection in sessionStorage and redirect to registration
            sessionStorage.setItem('selectedPlan', planKey);
            sessionStorage.setItem('selectedPeriod', months);
            window.location.href = "{{ url_for('tenant.register') }}";
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
