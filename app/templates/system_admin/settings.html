{% extends "system_admin/base.html" %}

{% block title %}System Settings - TSG ERP{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100">
    <div class="max-w-7xl mx-auto px-6 py-8">
        <!-- Page Header -->
        <div class="mb-8">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold bg-gradient-to-r from-gray-800 via-blue-700 to-indigo-800 bg-clip-text text-transparent">
                        System Settings
                    </h1>
                    <p class="text-gray-600 mt-2">Configure global system parameters and welcome page content</p>
                </div>
                <button onclick="saveAllSettings()" class="px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-xl font-semibold hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
                    <i class="fas fa-save mr-2"></i>Save All Changes
                </button>
            </div>
        </div>

        <!-- Settings Tabs -->
        <div class="mb-6">
            <div class="flex space-x-2 bg-white/60 backdrop-blur-lg rounded-xl p-2 shadow-lg border border-white/20">
                <button onclick="switchTab('welcome')" id="tab-welcome" class="flex-1 px-6 py-3 rounded-lg font-semibold transition-all duration-300 bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-md">
                    <i class="fas fa-home mr-2"></i>Welcome Page
                </button>
                <button onclick="switchTab('social')" id="tab-social" class="flex-1 px-6 py-3 rounded-lg font-semibold transition-all duration-300 text-gray-700 hover:bg-white/50">
                    <i class="fas fa-share-alt mr-2"></i>Social Media
                </button>
                <button onclick="switchTab('contact')" id="tab-contact" class="flex-1 px-6 py-3 rounded-lg font-semibold transition-all duration-300 text-gray-700 hover:bg-white/50">
                    <i class="fas fa-address-book mr-2"></i>Contact Info
                </button>
                <button onclick="switchTab('tutorials')" id="tab-tutorials" class="flex-1 px-6 py-3 rounded-lg font-semibold transition-all duration-300 text-gray-700 hover:bg-white/50">
                    <i class="fas fa-video mr-2"></i>Video Tutorials
                </button>
            </div>
        </div>

        <!-- Welcome Page Settings -->
        <div id="content-welcome" class="tab-content">
            <div class="grid grid-cols-1 gap-6">
                <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl border border-white/20 p-6">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mr-4">
                            <i class="fas fa-heading text-white text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-gray-800">Hero Section</h2>
                            <p class="text-sm text-gray-600">Main landing page content</p>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Hero Title</label>
                            <input type="text" id="hero_title" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="Transform Your Restaurant Operations">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Hero Subtitle</label>
                            <input type="text" id="hero_subtitle" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="Comprehensive Multi-Tenant ERP Solution">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Hero Description</label>
                            <textarea id="hero_description" rows="3" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="Streamline your restaurant management..."></textarea>
                        </div>
                    </div>
                </div>

                <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl border border-white/20 p-6">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mr-4">
                            <i class="fas fa-building text-white text-xl"></i>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold text-gray-800">Company Information</h2>
                            <p class="text-sm text-gray-600">Your company details</p>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Company Name</label>
                            <input type="text" id="company_name" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" placeholder="TSG Cafe ERP">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Company Tagline</label>
                            <input type="text" id="company_tagline" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" placeholder="Powered by Trisync Global">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Company Description</label>
                            <textarea id="company_description" rows="3" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" placeholder="The leading multi-tenant restaurant management solution..."></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Copyright Text</label>
                            <input type="text" id="copyright_text" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all" placeholder="Â© 2025 Trisync Global. All rights reserved.">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Social Media Settings -->
        <div id="content-social" class="tab-content hidden">
            <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl border border-white/20 p-6">
                <div class="flex items-center mb-6">
                    <div class="w-12 h-12 bg-gradient-to-br from-pink-500 to-rose-600 rounded-xl flex items-center justify-center mr-4">
                        <i class="fas fa-share-alt text-white text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Social Media Links</h2>
                        <p class="text-sm text-gray-600">Connect your social media profiles</p>
                    </div>
                </div>

                <div class="space-y-4">
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-facebook-f text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Facebook URL</label>
                            <input type="url" id="social_facebook" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all" placeholder="https://facebook.com/yourpage">
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-sky-500 rounded-xl flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-twitter text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Twitter/X URL</label>
                            <input type="url" id="social_twitter" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-sky-500 focus:border-transparent transition-all" placeholder="https://twitter.com/yourprofile">
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-blue-700 rounded-xl flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-linkedin-in text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 mb-2">LinkedIn URL</label>
                            <input type="url" id="social_linkedin" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-700 focus:border-transparent transition-all" placeholder="https://linkedin.com/company/yourcompany">
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 rounded-xl flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-instagram text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 mb-2">Instagram URL</label>
                            <input type="url" id="social_instagram" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent transition-all" placeholder="https://instagram.com/yourprofile">
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-red-600 rounded-xl flex items-center justify-center flex-shrink-0">
                            <i class="fab fa-youtube text-white text-xl"></i>
                        </div>
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 mb-2">YouTube URL</label>
                            <input type="url" id="social_youtube" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all" placeholder="https://youtube.com/@yourchannel">
                        </div>
                    </div>

                    <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 mt-6">
                        <div class="flex items-start">
                            <i class="fas fa-info-circle text-blue-600 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-semibold text-blue-900">How it works</h4>
                                <p class="text-sm text-blue-800 mt-1">These links will be displayed on your welcome page footer. When visitors click on a social media icon, they'll be redirected to your profile. Leave empty to hide the icon.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Information Settings -->
        <div id="content-contact" class="tab-content hidden">
            <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl border border-white/20 p-6">
                <div class="flex items-center mb-6">
                    <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mr-4">
                        <i class="fas fa-address-book text-white text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Contact Information</h2>
                        <p class="text-sm text-gray-600">Display contact details on welcome page</p>
                    </div>
                </div>

                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-map-marker-alt text-green-600 mr-2"></i>Business Address
                        </label>
                        <textarea id="contact_address" rows="2" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all" placeholder="123 Restaurant Ave, Food City, FC 12345"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-phone text-green-600 mr-2"></i>Phone Number
                        </label>
                        <input type="tel" id="contact_phone" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all" placeholder="+1 (555) 123-4567">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-envelope text-green-600 mr-2"></i>Support Email
                        </label>
                        <input type="email" id="contact_email" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all" placeholder="support@tsgcafeerp.com">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-clock text-green-600 mr-2"></i>Business Hours
                        </label>
                        <input type="text" id="contact_hours" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all" placeholder="Mon - Fri: 9:00 AM - 6:00 PM">
                    </div>

                    <div class="bg-green-50 border border-green-200 rounded-xl p-4 mt-6">
                        <div class="flex items-start">
                            <i class="fas fa-lightbulb text-green-600 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-semibold text-green-900">Display on Welcome Page</h4>
                                <p class="text-sm text-green-800 mt-1">This contact information will appear in the footer section of your welcome page, making it easy for potential customers to reach you.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Tutorials Settings -->
        <div id="content-tutorials" class="tab-content hidden">
            <div class="bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl border border-white/20 p-6">
                <div class="flex items-center mb-6">
                    <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-rose-600 rounded-xl flex items-center justify-center mr-4">
                        <i class="fas fa-video text-white text-xl"></i>
                    </div>
                    <div>
                        <h2 class="text-xl font-bold text-gray-800">Video Tutorials</h2>
                        <p class="text-sm text-gray-600">YouTube or Vimeo video links for user guidance</p>
                    </div>
                </div>

                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-rocket text-red-600 mr-2"></i>Getting Started Tutorial
                        </label>
                        <input type="url" id="tutorial_getting_started" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all" placeholder="https://youtube.com/watch?v=...">
                        <p class="text-xs text-gray-500 mt-1">Introduction video for new users</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-cash-register text-red-600 mr-2"></i>POS System Tutorial
                        </label>
                        <input type="url" id="tutorial_pos_system" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all" placeholder="https://youtube.com/watch?v=...">
                        <p class="text-xs text-gray-500 mt-1">How to use the POS system</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-boxes text-red-600 mr-2"></i>Inventory Management Tutorial
                        </label>
                        <input type="url" id="tutorial_inventory" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all" placeholder="https://youtube.com/watch?v=...">
                        <p class="text-xs text-gray-500 mt-1">Managing inventory and stock</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-chart-bar text-red-600 mr-2"></i>Reports & Analytics Tutorial
                        </label>
                        <input type="url" id="tutorial_reports" class="w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all" placeholder="https://youtube.com/watch?v=...">
                        <p class="text-xs text-gray-500 mt-1">Understanding reports and analytics</p>
                    </div>

                    <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-4 mt-6">
                        <div class="flex items-start">
                            <i class="fas fa-video text-yellow-600 mt-1 mr-3"></i>
                            <div>
                                <h4 class="font-semibold text-yellow-900">Video Tutorial Links</h4>
                                <p class="text-sm text-yellow-800 mt-1">Add YouTube or Vimeo video URLs. These will be accessible from the Resources section on your welcome page. Videos help users learn how to use your system effectively.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
let currentTab = 'welcome';

// Load settings on page load
document.addEventListener('DOMContentLoaded', function() {
    loadWelcomePageSettings();
});

function switchTab(tabName) {
    // Hide all content
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.add('hidden');
    });
    
    // Remove active class from all tabs
    document.querySelectorAll('[id^="tab-"]').forEach(tab => {
        tab.classList.remove('bg-gradient-to-r', 'from-blue-500', 'to-indigo-600', 'text-white', 'shadow-md');
        tab.classList.add('text-gray-700', 'hover:bg-white/50');
    });
    
    // Show selected content
    document.getElementById('content-' + tabName).classList.remove('hidden');
    
    // Add active class to selected tab
    const activeTab = document.getElementById('tab-' + tabName);
    activeTab.classList.remove('text-gray-700', 'hover:bg-white/50');
    activeTab.classList.add('bg-gradient-to-r', 'from-blue-500', 'to-indigo-600', 'text-white', 'shadow-md');
    
    currentTab = tabName;
}

async function loadWelcomePageSettings() {
    try {
        const response = await fetch('/system-admin/settings/api/welcome-page-settings');
        const data = await response.json();
        
        if (data.settings) {
            // Populate form fields
            Object.keys(data.settings).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = data.settings[key] === 'true' || data.settings[key] === true;
                    } else {
                        element.value = data.settings[key] || '';
                    }
                }
            });
        }
    } catch (error) {
        console.error('Error loading settings:', error);
        showNotification('Error loading settings', 'error');
    }
}

async function saveAllSettings() {
    const settings = {};
    
    // Collect all input fields
    document.querySelectorAll('input, textarea, select').forEach(element => {
        if (element.id) {
            if (element.type === 'checkbox') {
                settings[element.id] = element.checked;
            } else {
                settings[element.id] = element.value;
            }
        }
    });

    try {
        const response = await fetch('/system-admin/settings/api/welcome-page-settings', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(settings)
        });

        const result = await response.json();
        
        if (result.success) {
            showNotification('Settings saved successfully!', 'success');
        } else {
            showNotification('Error saving settings: ' + (result.error || 'Unknown error'), 'error');
        }
    } catch (error) {
        console.error('Error saving settings:', error);
        showNotification('Error saving settings', 'error');
    }
}

function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 px-6 py-4 rounded-xl shadow-2xl z-50 ${
        type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500'
    } text-white font-semibold transform transition-all duration-300`;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateY(-20px)';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}
</script>
{% endblock %}
