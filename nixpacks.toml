[phases.setup]
nixPkgs = ["python311", "postgresql"]

[phases.install]
cmds = ["pip install -r requirements.txt"]

[phases.build]
cmds = ["python -m flask db upgrade || echo 'Migration will run on first start'"]

[start]
cmd = "python -m flask db init || true && python -m flask db migrate || true && python -m flask db upgrade && gunicorn run:app --bind 0.0.0.0:$PORT"
